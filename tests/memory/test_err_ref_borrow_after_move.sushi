# Test: Error when trying to pass a moved variable as reference
# Should fail with CE2405: cannot borrow moved variable

fn modify_array(&poke i32[] arr) ~:
    arr.push(42)
    return Result.Ok(~)

fn main(string[] args) i32:
    let i32[] arr1 = from([1, 2, 3])
    let i32[] arr2 = new()
    arr2 := arr1  # Move arr1 to arr2

    let Result<~, StdError> r = modify_array(&poke arr1)  # ERROR: arr1 has been moved
    return Result.Ok(0)
