# TEST_TYPE: runtime
# EXPECT_RUNTIME_EXIT: 0
# Test RAII cleanup on early returns from functions


struct Container:
    i32[] numbers
    string name

fn test_early_return(bool should_return_early) i32:
    let Container c = Container(new(), "test")
    c.numbers.push(10)
    c.numbers.push(20)

    if (should_return_early):
        println("Early return - RAII should clean up")
        return Result.Ok(1)  # Early return - c.numbers should be cleaned up here

    c.numbers.push(30)
    println("Normal path")
    return Result.Ok(2)  # Normal return - c.numbers should be cleaned up here

fn main() i32:
    let i32 result1 = test_early_return(true).realise(0)
    println("Result1: {result1}")

    let i32 result2 = test_early_return(false).realise(1)
    println("Result2: {result2}")

    return Result.Ok(0)
