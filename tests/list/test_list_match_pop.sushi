fn main() i32:
    let List<i32> data = List.new()
    data.push(42)
    data.push(100)

    # Direct match on .pop() return value
    match data.pop():
        Maybe.Some(val) ->
            if (val != 100):
                println("ERROR: Expected 100, got {val}")
                return Result.Ok(1)
        Maybe.None() ->
            println("ERROR: Should have popped element")
            return Result.Ok(2)

    # Pop again
    match data.pop():
        Maybe.Some(val) ->
            if (val != 42):
                println("ERROR: Expected 42, got {val}")
                return Result.Ok(3)
        Maybe.None() ->
            println("ERROR: Should have popped second element")
            return Result.Ok(4)

    # Pop from empty list should return None
    match data.pop():
        Maybe.Some(_) ->
            println("ERROR: Should not have element after two pops")
            return Result.Ok(5)
        Maybe.None() ->
            println("OK: Empty list returns None")

    return Result.Ok(0)
