# Test library struct and enum types pass through type checking
# EXPECT_RUNTIME_EXIT: 0
# EXPECT_STDOUT_CONTAINS: "30"
# EXPECT_STDOUT_CONTAINS: "red"
# EXPECT_STDOUT_CONTAINS: "blue 5"

use <lib/types_lib>

fn main() i32:
    let Result<Point, StdError> r1 = make_point(10, 20)
    match r1:
        Result.Ok(p) ->
            let Result<i32, StdError> r2 = point_sum(p)
            match r2:
                Result.Ok(sum) -> println(sum)
                Result.Err(_) -> return Result.Ok(1)
        Result.Err(_) -> return Result.Ok(1)

    let Result<Color, StdError> r3 = get_color(0)
    match r3:
        Result.Ok(c1) ->
            let Result<string, StdError> r4 = color_name(c1)
            match r4:
                Result.Ok(name1) -> println(name1)
                Result.Err(_) -> return Result.Ok(1)
        Result.Err(_) -> return Result.Ok(1)

    let Result<Color, StdError> r5 = get_color(5)
    match r5:
        Result.Ok(c2) ->
            let Result<string, StdError> r6 = color_name(c2)
            match r6:
                Result.Ok(name2) -> println(name2)
                Result.Err(_) -> return Result.Ok(1)
        Result.Err(_) -> return Result.Ok(1)

    return Result.Ok(0)
