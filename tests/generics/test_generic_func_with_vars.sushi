# Test generic functions using type parameters in variable declarations
# This tests body substitution where T appears in let statements

fn create_pair<T>(T first, T second) T:
    # Variable declaration with generic type - use both params
    let T result = first
    # Copy second to temp and back to ensure both are used
    let T temp = second
    result := temp
    result := first
    return Result.Ok(result)

fn compute<T>(T value) T:
    # Multiple variable declarations with generic type
    let T a = value
    let T b = a
    let T c = b
    return Result.Ok(c)

fn run_test() i32:
    # Test with i32
    let i32 num1 = create_pair(10, 20)??
    let i32 num2 = compute(42)??

    # Test with string (still need to call to ensure monomorphization)
    if (create_pair("hello", "world")?? == ""):
        return Result.Ok(10)
    if (compute("test")?? == ""):
        return Result.Ok(11)

    # Verify values are correct
    if (num1 != 10):
        return Result.Ok(1)
    if (num2 != 42):
        return Result.Ok(2)

    return Result.Ok(0)

fn main() i32:
    let i32 result = run_test().realise(99)
    return Result.Ok(result)
