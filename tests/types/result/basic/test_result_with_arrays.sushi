# EXPECT_RUNTIME_EXIT: 0
# EXPECT_STDOUT_CONTAINS: PASS: Fixed array in Result works
# EXPECT_STDOUT_CONTAINS: PASS: Dynamic array in Result works
# EXPECT_STDERR_EMPTY: true

# Tests Result<T, E> with array types

enum MyError:
    Error

fn get_numbers() i32[3] | MyError:
    return Result.Ok([1, 2, 3])

fn get_dynamic_array() i32[] | MyError:
    return Result.Ok(from([4, 5, 6]))

fn main() i32:
    match get_numbers():
        Result.Ok(arr) ->
            if (arr[0] == 1 and arr[1] == 2 and arr[2] == 3):
                println("PASS: Fixed array in Result works")
            else:
                println("FAIL: Wrong array values")
                return Result.Ok(1)
        Result.Err(_) ->
            println("FAIL: Got error")
            return Result.Ok(1)

    match get_dynamic_array():
        Result.Ok(arr) ->
            if (arr.len() == 3 and arr[0] == 4):
                println("PASS: Dynamic array in Result works")
            else:
                println("FAIL: Wrong dynamic array")
                return Result.Ok(1)
        Result.Err(_) ->
            println("FAIL: Got error")
            return Result.Ok(1)

    return Result.Ok(0)
