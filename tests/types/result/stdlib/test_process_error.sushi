# EXPECT_RUNTIME_EXIT: 0
# EXPECT_STDOUT_CONTAINS: PASS: ProcessError.SpawnFailed works
# EXPECT_STDOUT_CONTAINS: PASS: ProcessError.ExitFailure works
# EXPECT_STDOUT_CONTAINS: PASS: ProcessError.SignalReceived works
# EXPECT_STDERR_EMPTY: true

# Tests ProcessError enum variants

fn spawn_process(string cmd) i32 | ProcessError:
    if (cmd == "bad"):
        return Result.Err(ProcessError.SpawnFailed)
    if (cmd == "fail"):
        return Result.Err(ProcessError.ExitFailure)
    if (cmd == "signal"):
        return Result.Err(ProcessError.SignalReceived)
    return Result.Ok(0)

fn main() i32:
    match spawn_process("bad"):
        Result.Err(ProcessError.SpawnFailed) ->
            println("PASS: ProcessError.SpawnFailed works")
        _ ->
            println("FAIL: SpawnFailed pattern failed")
            return Result.Ok(1)

    match spawn_process("fail"):
        Result.Err(ProcessError.ExitFailure) ->
            println("PASS: ProcessError.ExitFailure works")
        _ ->
            println("FAIL: ExitFailure pattern failed")
            return Result.Ok(1)

    match spawn_process("signal"):
        Result.Err(ProcessError.SignalReceived) ->
            println("PASS: ProcessError.SignalReceived works")
        _ ->
            println("FAIL: SignalReceived pattern failed")
            return Result.Ok(1)

    return Result.Ok(0)
