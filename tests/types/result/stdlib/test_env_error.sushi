# EXPECT_RUNTIME_EXIT: 0
# EXPECT_STDOUT_CONTAINS: PASS: EnvError.NotFound works
# EXPECT_STDOUT_CONTAINS: PASS: EnvError.InvalidValue works
# EXPECT_STDOUT_CONTAINS: PASS: EnvError.PermissionDenied works
# EXPECT_STDERR_EMPTY: true

# Tests EnvError enum variants

fn get_env_var(string name) string | EnvError:
    if (name == "MISSING"):
        return Result.Err(EnvError.NotFound)
    if (name == "INVALID"):
        return Result.Err(EnvError.InvalidValue)
    if (name == "FORBIDDEN"):
        return Result.Err(EnvError.PermissionDenied)
    return Result.Ok("value")

fn main() i32:
    match get_env_var("MISSING"):
        Result.Err(EnvError.NotFound) ->
            println("PASS: EnvError.NotFound works")
        _ ->
            println("FAIL: NotFound pattern failed")
            return Result.Ok(1)

    match get_env_var("INVALID"):
        Result.Err(EnvError.InvalidValue) ->
            println("PASS: EnvError.InvalidValue works")
        _ ->
            println("FAIL: InvalidValue pattern failed")
            return Result.Ok(1)

    match get_env_var("FORBIDDEN"):
        Result.Err(EnvError.PermissionDenied) ->
            println("PASS: EnvError.PermissionDenied works")
        _ ->
            println("FAIL: PermissionDenied pattern failed")
            return Result.Ok(1)

    return Result.Ok(0)
