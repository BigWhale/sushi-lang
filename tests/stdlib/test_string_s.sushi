# TEST_TYPE: runtime
# EXPECT_RUNTIME_EXIT: 0
# EXPECT_STDOUT: Hello
# EXPECT_STDOUT: World
# EXPECT_STDOUT: caf
# EXPECT_STDOUT: 3
# EXPECT_STDOUT: f√©
# EXPECT_STDOUT: 2
# EXPECT_STDOUT: Â•Ω‰∏ñ
# EXPECT_STDOUT: 2
# EXPECT_STDOUT: 6
# EXPECT_STDOUT: 0
# EXPECT_STDOUT: 0
# EXPECT_STDOUT: llo
# EXPECT_STDOUT: Hel
# EXPECT_STDOUT: copy
# EXPECT_STDOUT: d
# EXPECT_STDOUT: 2

use <collections/strings>

fn main() i32:
    # Test 1: Basic slice - characters 0 to 5
    let string s1 = "Hello World"
    let string slice1 = s1.s(0, 5)
    println(slice1)  # Expected: Hello

    # Test 2: Middle slice
    let string s2 = "Hello World"
    let string slice2 = s2.s(6, 11)
    println(slice2)  # Expected: World

    # Test 3: UTF-8 aware - character-based (not byte-based)
    let string s3 = "caf√©"
    let string slice3 = s3.s(0, 3)
    println(slice3)  # Expected: caf (3 characters)
    println(slice3.len())  # Expected: 3

    # Test 4: UTF-8 aware - include multi-byte character
    let string s4 = "caf√©"
    let string slice4 = s4.s(2, 4)
    println(slice4)  # Expected: f√© (2 characters)
    println(slice4.len())  # Expected: 2

    # Test 5: UTF-8 Chinese characters
    let string s5 = "‰Ω†Â•Ω‰∏ñÁïå"
    let string slice5 = s5.s(1, 3)
    println(slice5)  # Expected: Â•Ω‰∏ñ (2 characters)
    println(slice5.len())  # Expected: 2
    println(slice5.size())  # Expected: 6 (6 bytes)

    # Test 6: Empty slice (start == end)
    let string s6 = "test"
    let string slice6 = s6.s(2, 2)
    println(slice6.size())  # Expected: 0

    # Test 7: Start > end (should return empty)
    let string s7 = "test"
    let string slice7 = s7.s(3, 1)
    println(slice7.size())  # Expected: 0

    # Test 8: End beyond string length (should clamp to length)
    let string s8 = "Hello"
    let string slice8 = s8.s(2, 100)
    println(slice8)  # Expected: llo

    # Test 9: Negative start (should clamp to 0)
    let string s9 = "Hello"
    let string slice9 = s9.s(-5, 3)
    println(slice9)  # Expected: Hel

    # Test 10: Full string copy
    let string s10 = "copy"
    let string slice10 = s10.s(0, 4)
    println(slice10)  # Expected: copy

    # Test 11: Single character slice
    let string s11 = "abcdef"
    let string slice11 = s11.s(3, 4)
    println(slice11)  # Expected: d

    # Test 12: UTF-8 emoji slice
    let string s12 = "üëãüåç Hello"
    let string slice12 = s12.s(0, 2)
    println(slice12.len())  # Expected: 2 (2 emojis)

    return Result.Ok(0)
